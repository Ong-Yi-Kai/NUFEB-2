LAMMPS (1 Feb 2014)
# NUFEB simulation

atom_style	bio
atom_modify	map array sort 10000 5e-7
boundary	ff ff ff
newton		off
#processors  2 1 1

#radius x y z outerradius sub o2 nh4 no2 no3
communicate single vel yes
read_data 	/home/bowen/Workspace/nufeb/code/input/testing/flat_surface.in
  orthogonal box = (1e-05 1e-05 0) to (3e-05 3e-05 4e-05)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  5 atoms
#read_data 	IC5nut.in
#read_data 	IC4mmcohe.in

group HET type 1
1 atoms in group HET
group AOB type 2
1 atoms in group AOB
group NOB type 3
1 atoms in group NOB
group EPS type 4
1 atoms in group EPS
group inert type 5
1 atoms in group inert


neighbor	5.0e-7 bin
neigh_modify	delay 0

#pair_style  none
pair_style  gran/hooke/history 200 NULL 50 NULL 0.0 1
pair_coeff  * *
timestep	1

#velocity    all set 0.0 0.0 0.0 units box

fix		1 all nve/limit 1e-11

#fix		2 all gravity 1.47 vector 0 0 -1 # spherical 90.0 -180.0
fix     3 all fdrag


fix xw all wall/gran 200 NULL 50.0 NULL 1.5 0 xplane  0.00001  0.00003
fix yw all wall/gran 200 NULL 50.0 NULL 1.5 0 yplane  0.00001  0.00003
fix zw all wall/gran 200 NULL 50.0 NULL 1.5 0 zplane  0.00000  0.00004

variable kanc equal 50

fix xwa all walladh v_kanc xplane  0.00001  0.00003
fix ywa all walladh v_kanc yplane  0.00001  0.00003
fix zwa all walladh v_kanc zplane  0.00000  0.00004


#Defining affinity variables: list from Jaya
variable KsHET equal 0.01
variable Ko2HET equal 0.81
variable Kno2HET equal 0.0003
variable Kno3HET equal 0.0003

variable Knh4AOB equal 0.001
variable Ko2AOB equal 0.0005

variable Kno2NOB equal 0.0013
variable Ko2NOB equal 0.00068

#Defining maximum growth variables: list from Jaya
variable MumHET equal 0.0006944444
variable MumAOB equal 0.0003472222
variable MumNOB equal 0.0003472222
variable etaHET equal 0.9

#Defining decay rates variables: list from Jaya
variable bHET equal 0.0 #0.00000462962
variable bAOB equal 0.0 #0.00000127314
variable bNOB equal 0.0 #0.00000127314
variable bEPS equal 0.0 #0.00000196759

#Defining yield coefficient variables
variable YHET equal 0.61
variable YAOB equal 0.33
variable YNOB equal 0.083
variable YEPS equal 0.18
variable Y1 equal 0.4

#Defining EPS density and ratio variables
variable EPSdens equal 30
variable EPSratio equal 1.25

#Defining diffusion coefficient variables
variable Do2 equal 2.0e-9
variable Dnh4 equal 1.4e-9
variable Dno2 equal 1.2e-9
variable Dno3 equal 1.2e-9
variable Ds equal 0.4e-9

#Defining diffusion time variable
variable diffT equal 1e-4

#Defining inlet concentrations for non-ghost cells
variable sub equal  8.00e-02
variable o2 equal 10.00e-03
variable no2 equal 8.000e-03
variable no3 equal 1.0000e-05
variable nh4 equal 9.00e-02

#Defining inlet concentrations for boundary conditions
variable BCsub equal 8.00e-02
variable BCo2 equal 10.00e-03
variable BCno2 equal 8.000e-03
variable BCno3 equal 1.0000e-05
variable BCnh4 equal 9.00e-02

variable factor equal 1.5

variable ke equal 5e+10

#variable rate1 equal 0.001
fix g1 all diffnugrowth 10 v_KsHET v_Ko2HET v_Kno2HET v_Kno3HET v_Knh4AOB v_Ko2AOB v_Kno2NOB v_Ko2NOB v_MumHET v_MumAOB v_MumNOB v_etaHET v_bHET v_bAOB v_bNOB v_bEPS v_YHET v_YAOB v_YNOB v_YEPS v_Y1 v_EPSdens v_Do2 v_Dnh4 v_Dno2 v_Dno3 v_Ds v_diffT v_sub v_o2 v_no2 v_no3 v_nh4 5 5 5 dirich v_BCsub v_BCo2 v_BCno2 v_BCno3 v_BCnh4

#fix dt1 HET death 1 v_bHET v_factor 1952467
#fix dt2 AOB death 1 v_bAOB v_factor 1234312
#fix dt3 NOB death 1 v_bNOB v_factor 1325352
fix d1 HET divide 1000 v_EPSdens 2.0 1242242
fix d2 AOB divide 1000 v_EPSdens 2.0 1242242
fix d3 NOB divide 1000 v_EPSdens 2.0 1242242

fix e1 HET eps_extract 1000 v_EPSratio v_EPSdens 1242242
#fix j1 all epsadh 1 v_ke


#dump		id1 HET custom 2000 HET.bubblemd radius outerradius
#dump		id2 all custom 1 snapshot.bubblemd id type radius outerradius mass outermass sub
#dump		id2 EPS custom 1000 snapshot2.bubblemd id type diameter mass x y z vx vy vz
dump		id all custom 2000 snapshot.bubblemd id type diameter x y z vx vy vz fx fy fz


#dump d0 all image 100 dump.*.jpg type type
#dump m0 all movie 1000 movie.mpg type type size 640 480

#thermo_style    custom step atoms ke vol
thermo_style    custom step atoms nhet naob nnob neps ninert
#thermo_style  granular # not work. syntax change?
#thermo_style  one   # granular does not work
thermo		1000

thermo_modify	lost ignore
#restart	1000000  restart.*.bubblemd

run  4000000
Memory usage per processor = 197.605 Mbytes
Step Atoms nHET nAOB nNOB nEPS nInert 
       0        5            1            1            1            1            1 
    1000        6            1            1            1            2            1 
    2000        7            1            1            1            3            1 
    3000        8            2            1            1            3            1 
    4000        8            2            1            1            3            1 
    5000       10            2            1            1            5            1 
    6000       10            2            1            1            5            1 
    7000       11            3            1            1            5            1 
    8000       11            3            1            1            5            1 
    9000       12            4            1            1            5            1 
   10000       13            4            1            1            6            1 
   11000       18            5            2            1            9            1 
   12000       18            5            2            1            9            1 
   13000       18            5            2            1            9            1 
   14000       18            5            2            1            9            1 
   15000       23            7            3            1           11            1 
   16000       25            8            4            1           11            1 
   17000       26            9            4            1           11            1 
   18000       26            9            4            1           11            1 
   19000       26            9            4            1           11            1 
   20000       28            9            4            2           12            1 
   21000       30            9            5            2           13            1 
   22000       32           10            6            2           13            1 
   23000       37           11            6            2           17            1 
   24000       39           12            7            2           17            1 
   25000       39           12            7            2           17            1 
   26000       39           12            7            2           17            1 
   27000       43           12            9            2           19            1 
   28000       43           12            9            2           19            1 
   29000       46           13            9            2           21            1 
   30000       50           13            9            3           24            1 
   31000       54           15           10            3           25            1 
   32000       55           15           11            3           25            1 
   33000       56           16           11            3           25            1 
   34000       59           17           12            4           25            1 
   35000       61           17           13            4           26            1 
   36000       62           18           13            4           26            1 
   37000       63           18           14            4           26            1 
   38000       67           19           16            4           27            1 
   39000       68           19           16            4           28            1 
   40000       68           19           16            4           28            1 
   41000       68           19           16            4           28            1 
   42000       68           19           16            4           28            1 
   43000       70           19           17            4           29            1 
   44000       72           20           17            4           30            1 
   45000       73           21           17            4           30            1 
   46000       75           22           18            4           30            1 
   47000       79           23           20            4           31            1 
   48000       83           24           20            4           34            1 
   49000       88           24           22            5           36            1 
   50000       90           24           23            6           36            1 
   51000       91           24           24            6           36            1 
   52000       93           25           24            7           36            1 
   53000       97           25           27            7           37            1 
   54000      100           25           30            7           37            1 
   55000      104           26           30            7           40            1 
   56000      109           28           31            7           42            1 
   57000      112           28           32            7           44            1 
   58000      114           29           32            7           45            1 
   59000      117           30           34            7           45            1 
   60000      119           31           34            8           45            1 
   61000      120           32           34            8           45            1 
   62000      122           32           34            8           47            1 
   63000      124           33           35            8           47            1 
   64000      126           35           35            8           47            1 
   65000      133           35           37            8           52            1 
   66000      137           35           40            8           53            1 
   67000      139           36           41            8           53            1 
   68000      141           37           42            8           53            1 
   69000      144           37           44            9           53            1 
   70000      147           38           45           10           53            1 
   71000      154           38           49           10           56            1 
   72000      158           39           51           10           57            1 
   73000      162           40           53           11           57            1 
   74000      165           40           53           11           60            1 
   75000      166           40           54           11           60            1 
   76000      169           42           55           11           60            1 
   77000      176           42           58           11           64            1 
   78000      180           44           58           11           66            1 
   79000      186           45           61           12           67            1 
   80000      189           46           61           12           69            1 
   81000      194           48           63           13           69            1 
   82000      199           49           65           13           71            1 
   83000      201           50           66           13           71            1 
   84000      209           51           68           15           74            1 
   85000      213           52           69           15           76            1 
   86000      217           54           70           15           77            1 
   87000      219           54           71           15           78            1 
   88000      227           57           72           15           82            1 
   89000      232           59           74           15           83            1 
   90000      237           60           78           15           83            1 
   91000      239           60           80           15           83            1 
   92000      247           62           82           15           87            1 
   93000      248           62           82           15           88            1 
   94000      251           62           83           15           90            1 
   95000      257           64           85           16           91            1 
   96000      263           65           85           17           95            1 
   97000      275           68           86           17          103            1 
   98000      279           69           88           17          104            1 
   99000      283           69           92           17          104            1 
  100000      287           69           95           17          105            1 
  101000      291           70           98           17          105            1 
  102000      295           70          100           17          107            1 
  103000      299           73          100           17          108            1 
  104000      303           74          101           18          109            1 
  105000      309           76          104           18          110            1 
  106000      314           78          106           18          111            1 
  107000      321           81          108           18          113            1 
  108000      328           81          111           18          117            1 
  109000      336           81          113           18          123            1 
  110000      341           83          114           18          125            1 
  111000      345           84          116           19          125            1 
  112000      346           84          116           19          126            1 
  113000      353           85          118           19          130            1 
  114000      355           85          118           19          132            1 
  115000      362           86          123           19          133            1 
  116000      368           87          124           19          137            1 
  117000      375           88          126           19          141            1 
  118000      382           90          128           19          144            1 
  119000      389           92          129           20          147            1 
  120000      394           94          131           21          147            1 
  121000      397           95          133           21          147            1 
  122000      400           96          133           21          149            1 
  123000      404           96          135           21          151            1 
  124000      413           99          137           22          154            1 
  125000      415           99          138           23          154            1 
  126000      418           99          141           23          154            1 
  127000      429          100          145           23          160            1 
  128000      434          101          149           23          160            1 
  129000      445          103          153           24          164            1 
  130000      447          105          153           24          164            1 
  131000      454          106          156           24          167            1 
  132000      462          108          157           26          170            1 
  133000      475          111          164           26          173            1 
  134000      480          111          166           26          176            1 
  135000      485          112          167           26          179            1 
  136000      492          114          171           26          180            1 
  137000      501          117          175           26          182            1 
  138000      506          117          177           26          185            1 
  139000      523          123          179           26          194            1 
  140000      534          124          184           26          199            1 
  141000      541          124          186           26          204            1 
  142000      548          128          187           26          206            1 
  143000      553          129          188           26          209            1 
  144000      560          132          190           26          211            1 
  145000      567          133          195           27          211            1 
  146000      573          134          197           27          214            1 
  147000      574          134          198           27          214            1 
  148000      584          137          200           27          219            1 
  149000      589          139          202           27          220            1 
  150000      591          141          202           27          220            1 
  151000      595          142          204           27          221            1 
  152000      601          144          206           27          223            1 
  153000      605          148          206           27          223            1 
  154000      610          150          209           27          223            1 
  155000      619          151          212           28          227            1 
  156000      627          152          213           28          233            1 
  157000      634          155          215           28          235            1 
  158000      643          157          219           28          238            1 
  159000      653          158          223           29          242            1 
  160000      664          160          229           29          245            1 
  161000      668          160          232           29          246            1 
  162000      675          160          235           29          250            1 
  163000      681          162          237           29          252            1 
  164000      695          168          240           30          256            1 
  165000      707          175          242           30          259            1 
  166000      717          176          247           30          263            1 
  167000      725          179          250           30          265            1 
  168000      733          179          256           30          267            1 
  169000      743          179          259           30          274            1 
  170000      749          180          261           30          277            1 
  171000      762          183          266           30          282            1 
  172000      778          185          270           30          292            1 
  173000      789          190          272           30          296            1 
  174000      796          191          272           30          302            1 
  175000      811          197          275           30          308            1 
  176000      822          200          280           30          311            1 
  177000      841          205          285           30          320            1 
  178000      853          208          290           30          324            1 
  179000      863          213          292           30          327            1 
  180000      871          219          292           30          329            1 
  181000      884          221          297           30          335            1 
  182000      894          224          303           30          336            1 
  183000      908          228          306           32          341            1 
  184000      919          232          310           32          344            1 
  185000      934          236          312           33          352            1 
  186000      954          239          317           33          364            1 
  187000      962          241          319           33          368            1 
  188000      979          249          322           33          374            1 
  189000      987          252          324           33          377            1 
  190000      997          256          329           33          378            1 
  191000     1005          258          334           33          379            1 
  192000     1015          264          334           33          383            1 
  193000     1029          265          338           33          392            1 
  194000     1045          270          344           34          396            1 
  195000     1057          273          350           34          399            1 
  196000     1066          275          353           34          403            1 
  197000     1083          279          362           34          407            1 
  198000     1097          282          370           34          410            1 
  199000     1109          284          375           35          414            1 
  200000     1120          285          380           35          419            1 
  201000     1140          291          384           35          429            1 
  202000     1155          294          389           35          436            1 
  203000     1164          297          392           35          439            1 
  204000     1174          301          395           35          442            1 
  205000     1190          305          400           35          449            1 
  206000     1205          308          402           36          458            1 
  207000     1224          312          405           37          469            1 
  208000     1236          312          409           37          477            1 
  209000     1257          317          414           37          488            1 
  210000     1268          319          422           37          489            1 
  211000     1279          320          426           38          494            1 
  212000     1290          324          429           38          498            1 
  213000     1297          327          432           38          499            1 
  214000     1316          335          440           39          501            1 
  215000     1331          339          445           39          507            1 
  216000     1343          342          452           39          509            1 
  217000     1360          346          460           39          514            1 
  218000     1373          349          463           39          521            1 
  219000     1383          352          466           39          525            1 
  220000     1392          353          468           39          531            1 
  221000     1409          358          474           39          537            1 
  222000     1428          362          482           39          544            1 
  223000     1447          366          489           40          551            1 
  224000     1463          369          494           40          559            1 
  225000     1475          372          500           41          561            1 
  226000     1491          377          505           41          567            1 
  227000     1506          381          511           41          572            1 
  228000     1526          385          519           42          579            1 
  229000     1541          388          524           42          586            1 
  230000     1556          390          532           42          591            1 
  231000     1578          396          538           42          601            1 
  232000     1597          401          543           42          610            1 
  233000     1613          404          551           42          615            1 
  234000     1635          411          560           43          620            1 
  235000     1650          416          563           44          626            1 
  236000     1671          421          573           44          632            1 
  237000     1683          423          581           44          634            1 
  238000     1697          425          587           44          640            1 
  239000     1726       