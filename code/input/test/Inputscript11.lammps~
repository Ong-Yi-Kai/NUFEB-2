# NUFEB simulation

atom_style	bio
atom_modify	map array sort 10000 5e-7
boundary	ff ff ff
newton		off
#processors  2 1 1

#radius x y z outerradius sub o2 nh4 no2 no3
communicate single vel yes
read_data 	flat_surface_central.in
#read_data 	IC5nut.in
#read_data 	IC4mmcohe.in

group HET type 1
group AOB type 2
group NOB type 3 
group EPS type 4
group inert type 5


neighbor	5.0e-7 bin
neigh_modify	delay 0

#pair_style  none
pair_style  gran/hooke/history 200 NULL 50 NULL 0.0 1
pair_coeff  * *
timestep	10

#velocity    all set 0.0 0.0 0.0 units box

fix		1 all nve/limit 1e-11

#fix		2 all gravity 1.47 vector 0 0 -1 # spherical 90.0 -180.0 
fix     3 all fdrag


fix xw all wall/gran 200 NULL 50.0 NULL 1.5 0 xplane  0.00001  0.00003
fix yw all wall/gran 200 NULL 50.0 NULL 1.5 0 yplane  0.00001  0.00003 
fix zw all wall/gran 200 NULL 50.0 NULL 1.5 0 zplane  0.00000  0.00004 

variable kanc equal 50

fix xwa all walladh v_kanc xplane  0.00001  0.00003 
fix ywa all walladh v_kanc yplane  0.00001  0.00003 
fix zwa all walladh v_kanc zplane  0.00000  0.00004


#Defining affinity variables: list from Jaya 
variable KsHET equal 0.00991797114683129
variable Ko2HET equal 0.806039481561419
variable Kno2HET equal 0.000295223046829984
variable Kno3HET equal 0.000298447182112816

variable Knh4AOB equal 0.00100523147745719
variable Ko2AOB equal 0.000495401188637037

variable Kno2NOB equal 0.00131129139840746
variable Ko2NOB equal 0.000682089098069469

#Defining maximum growth variables: list from Jaya 
variable MumHET equal 7.00507199026775e-05
variable MumAOB equal 3.39767255036098e-05
variable MumNOB equal 3.42986456939019e-05
variable etaHET equal 0.599856981364321

#Defining decay rates variables: list from Jaya 
variable bHET equal 4.66474332835275e-06
variable bAOB equal 1.27260616167799e-06
variable bNOB equal 1.29757417735341e-06
variable bEPS equal 1.96870096488238e-06

#Defining yield coefficient variables
variable YHET equal 0.632065147549754
variable YAOB equal 0.325082643388651
variable YNOB equal 0.0815746744073622
variable YEPS equal 0.179609241954074
variable Y1 equal 0.404006143278927

#Defining EPS density and ratio variables
variable EPSdens equal 30
variable EPSratio equal 1.25

#Defining diffusion coefficient variables
variable Do2 equal 1.96620364421215e-09
variable Dnh4 equal 1.38457820848901e-09
variable Dno2 equal 1.17370425819397e-09
variable Dno3 equal 1.1950138781504e-09
variable Ds equal 3.92678417959604e-10

#Defining diffusion time variable
variable diffT equal 0.000101359614125611

#Defining inlet concentrations for non-ghost cells
variable sub equal 0.08015978299658
variable o2 equal 0.0102064265840366
variable no2 equal 0.00796151557447612
variable no3 equal 9.9282723934371e-06
variable nh4 equal 0.0906995869456474

#Defining inlet concentrations for boundary conditions
variable BCsub equal 0.0801067431515269
variable BCo2 equal 0.00986773372599808
variable BCno2 equal 0.00794717300582305
variable BCno3 equal 9.92288090144703e-06
variable BCnh4 equal 0.0902926452950318

variable factor equal 1.5

variable ke equal 5e+10

#variable rate1 equal 0.001
fix g1 all diffnugrowth 1 100 v_KsHET v_Ko2HET v_Kno2HET v_Kno3HET v_Knh4AOB v_Ko2AOB v_Kno2NOB v_Ko2NOB v_MumHET v_MumAOB v_MumNOB v_etaHET v_bHET v_bAOB v_bNOB v_bEPS v_YHET v_YAOB v_YNOB v_YEPS v_Y1 v_EPSdens v_Do2 v_Dnh4 v_Dno2 v_Dno3 v_Ds v_diffT v_sub v_o2 v_no2 v_no3 v_nh4 5 5 5 dirich v_BCsub v_BCo2 v_BCno2 v_BCno3 v_BCnh4

fix dt1 HET death 1 v_bHET v_factor 1902427
fix dt2 AOB death 1 v_bAOB v_factor 1193170
fix dt3 NOB death 1 v_bNOB v_factor 1313113
fix d1 all divide 1000 v_EPSdens 2.0 1223564

fix e1 HET eps_extract 1000 v_EPSratio v_EPSdens 1242242
#fix j1 all epsadh 1 v_ke


#dump		id1 HET custom 2000 HET.bubblemd radius outerradius
#dump		id2 all custom 1 snapshot.bubblemd id type radius outerradius mass outermass sub
#dump		id2 EPS custom 1000 snapshot2.bubblemd id type diameter mass x y z vx vy vz
dump		id all custom 10000 snapshot.bubblemd id type diameter mass x y z sub o2 no2 no3 nh4


#dump d0 all image 100 dump.*.jpg type type
#dump m0 all movie 1000 movie.mpg type type size 640 480

#thermo_style    custom step atoms ke vol
thermo_style    custom step atoms nhet naob nnob neps ninert
#thermo_style  granular # not work. syntax change?
#thermo_style  one   # granular does not work
thermo		1000

thermo_modify	lost ignore
#restart	1000000  restart.*.bubblemd

run  200000

	

